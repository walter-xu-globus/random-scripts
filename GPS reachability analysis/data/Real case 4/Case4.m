clc; clf; clear;

L3L = [
    -0.9322311878204346,   0.35840073227882388,  0.04994036257266998,   24.821115493774415;
     0.34629470109939577,  0.9236316680908203,  -0.16426819562911988,   7.369929790496826;
    -0.10500044375658035, -0.13584206998348237, -0.9851506352424622,    9.196537971496582;
     0.0,                  0.0,                  0.0,                   1.0
];

L3R = [
    -0.9602102041244507,  -0.03023279272019863,  0.2776355445384979,  -14.625492095947266;
    -0.06251886487007141,  0.9921633005142212,  -0.10818183422088623,  12.553838729858399;
    -0.27218925952911379, -0.12123469263315201, -0.9545758366584778,    7.88688850402832;
     0.0,                  0.0,                  0.0,                   1.0
];

SI1L = [
    -0.7237673401832581,  -0.6900433301925659,   0.0005349181592464447,  34.60700607299805;
    -0.346008837223053,    0.3635898232460022,   0.8649161458015442,     7.386173248291016;
    -0.5970243811607361,   0.6258133053779602,  -0.5019155144691467,   -74.20997619628906;
     0.0,                  0.0,                  0.0,                   1.0
];

SI1R = [
    -0.7921043634414673,   0.6045185923576355,   0.08442749828100205,  -32.62772750854492;
     0.386347234249115,    0.38946425914764407,  0.8360937833786011,     4.682384014129639;
     0.47255241870880129,  0.6948919296264648,  -0.542050302028656,    -71.03498840332031;
     0.0,                  0.0,                  0.0,                   1.0
];

L4L = [
    -0.9842398166656494,   0.10849801450967789,  0.13964320719242097,   22.117612838745118;
     0.13419769704341889,  0.9725217819213867,   0.1902429461479187,     4.65538215637207;
    -0.11516520380973816,  0.20598414540290833, -0.9717549085617065,   -11.914546966552735;
     0.0,                  0.0,                  0.0,                   1.0
];

L4R = [
    -0.9384640455245972,  -0.22446990013122559,  0.26248204708099368,  -17.812591552734376;
    -0.20345892012119294,  0.9734342694282532,   0.10502694547176361,    6.147177696228027;
    -0.27908462285995486,  0.04515993595123291, -0.9592041373252869,   -14.424202919006348;
     0.0,                  0.0,                  0.0,                   1.0
];

L5L = [
    -0.9728285074234009,   0.16860850155353547,  0.15866994857788087,   25.800128936767579;
     0.21801511943340302,  0.8978061079978943,   0.3826405704021454,     5.8555474281311039;
    -0.07793857157230377,  0.4068359136581421,  -0.9101702570915222,   -34.701255798339847;
     0.0,                  0.0,                  0.0,                   1.0
];

L5R = [
    -0.9528717994689941,  -0.20343147218227387,  0.225056454539299,    -20.96989631652832;
    -0.0956316739320755,   0.9054465293884277,   0.41354694962501528,    5.8224968910217289;
    -0.28790539503097536,  0.37253499031066897, -0.882229208946228,    -36.08876419067383;
     0.0,                  0.0,                  0.0,                   1.0
];

L1L = [
    -0.9549988508224487,   0.2965693473815918,  -0.004884916823357344,  30.41384506225586;
     0.28232336044311526,  0.9038283228874207,  -0.3215397000312805,    28.813405990600587;
    -0.09094369411468506, -0.3084491789340973,  -0.9468833804130554,    56.222442626953128;
     0.0,                  0.0,                  0.0,                   1.0
];

L1R = [
    -0.9476393461227417,  -0.11522842943668366,  0.2978266775608063,    -8.141209602355957;
    -0.19938267767429353,  0.9420068264007568,  -0.269944429397583,     27.262969970703126;
    -0.24944929778575898, -0.3151915371417999,  -0.9156578183174133,    61.03730392456055;
     0.0,                  0.0,                  0.0,                   1.0
];

L2L = [
    -0.9319970607757568,   0.36062368750572207,  0.036499835550785068,  28.063766479492189;
     0.3458103835582733,   0.9148251414299011,  -0.2085900753736496,    19.80849838256836;
    -0.10861358791589737, -0.18178361654281617, -0.9773217439651489,    33.79047393798828;
     0.0,                  0.0,                  0.0,                   1.0
];

L2R = [
    -0.9495061039924622,  -0.13566134870052339,  0.28290078043937685,  -13.43183708190918;
    -0.18291202187538148,  0.9719523787498474,  -0.14782381057739259,   18.425640106201173;
    -0.2549121677875519,  -0.19210559129714967, -0.9476893544197083,    36.09390640258789;
     0.0,                  0.0,                  0.0,                   1.0
];

S1L = [
    -0.7172266840934753,  -0.696839451789856,    0.0005349230486899614,  31.8974666595459;
    -0.34942251443862917,  0.36031028628349306,  0.8649159669876099,     8.89167308807373;
    -0.6028999090194702,   0.6201543807983398,  -0.5019146800041199,   -72.12281036376953;
     0.0,                  0.0,                  0.0,                   1.0
];

S1R = [
    -0.7978352308273315,   0.5969348549842835,   0.08442747592926026,  -30.155160903930665;
     0.3826146125793457,   0.393131822347641,    0.8360938429832459,     6.395997047424316;
     0.4659024775028229,   0.6993678212165833,  -0.5420501828193665,   -68.00672912597656;
     0.0,                  0.0,                  0.0,                   1.0
];

S2L = [
    -0.8149040937423706,  -0.5736257433891296,   0.08297157287597656,   32.4271240234375;
    -0.29053106904029848,  0.5281464457511902,   0.7979055047035217,    29.679035186767579;
    -0.5015202760696411,   0.6261107921600342,  -0.5970444679260254,   -82.86447143554688;
     0.0,                  0.0,                  0.0,                   1.0
];

S2R = [
    -0.7550345659255981,   0.6546904444694519,  -0.036100395023822787, -23.179466247558595;
     0.4137688875198364,   0.5184512734413147,   0.7483338713645935,    32.649600982666019;
     0.508642852306366,    0.5500805377960205,  -0.6623391509056091,   -83.89691162109375;
     0.0,                  0.0,                  0.0,                   1.0
];

% Define colors for each level
c1 = [1.0, 0.0, 0.0];    % L1 - Red
c2 = [0.0, 0.8, 0.0];    % L2 - Green  
c3 = [0.0, 0.4, 1.0];    % L3 - Blue
c4 = [1.0, 0.5, 0.0];    % L4 - Orange
c5 = [0.6, 0.0, 0.8];    % L5 - Purple
c6 = [1.0, 0.8, 0.0];    % S1 - Yellow
c7 = [0.0, 0.8, 0.8];    % SI1 - Cyan
c8 = [1.0, 0.0, 1.0];    % S2 - Magenta

% Plot
figure; hold on; view(3); axis equal;

% L1
quiver3(L1L(1,4), L1L(2,4), L1L(3,4), L1L(1,2)*100, L1L(2,2)*100, L1L(3,2)*100, 0, 'Color', c1, 'LineWidth', 2, 'DisplayName', 'L1-L');
quiver3(L1R(1,4), L1R(2,4), L1R(3,4), L1R(1,2)*100, L1R(2,2)*100, L1R(3,2)*100, 0, 'Color', c1, 'LineWidth', 2, 'DisplayName', 'L1-R');

% L2
quiver3(L2L(1,4), L2L(2,4), L2L(3,4), L2L(1,2)*100, L2L(2,2)*100, L2L(3,2)*100, 0, 'Color', c2, 'LineWidth', 2, 'DisplayName', 'L2-L');
quiver3(L2R(1,4), L2R(2,4), L2R(3,4), L2R(1,2)*100, L2R(2,2)*100, L2R(3,2)*100, 0, 'Color', c2, 'LineWidth', 2, 'DisplayName', 'L2-R');

% L3
quiver3(L3L(1,4), L3L(2,4), L3L(3,4), L3L(1,2)*100, L3L(2,2)*100, L3L(3,2)*100, 0, 'Color', c3, 'LineWidth', 2, 'DisplayName', 'L3-L');
quiver3(L3R(1,4), L3R(2,4), L3R(3,4), L3R(1,2)*100, L3R(2,2)*100, L3R(3,2)*100, 0, 'Color', c3, 'LineWidth', 2, 'DisplayName', 'L3-R');

% L4
quiver3(L4L(1,4), L4L(2,4), L4L(3,4), L4L(1,2)*100, L4L(2,2)*100, L4L(3,2)*100, 0, 'Color', c4, 'LineWidth', 2, 'DisplayName', 'L4-L');
quiver3(L4R(1,4), L4R(2,4), L4R(3,4), L4R(1,2)*100, L4R(2,2)*100, L4R(3,2)*100, 0, 'Color', c4, 'LineWidth', 2, 'DisplayName', 'L4-R');

% L5
quiver3(L5L(1,4), L5L(2,4), L5L(3,4), L5L(1,2)*100, L5L(2,2)*100, L5L(3,2)*100, 0, 'Color', c5, 'LineWidth', 2, 'DisplayName', 'L5-L');
quiver3(L5R(1,4), L5R(2,4), L5R(3,4), L5R(1,2)*100, L5R(2,2)*100, L5R(3,2)*100, 0, 'Color', c5, 'LineWidth', 2, 'DisplayName', 'L5-R');

% S1
quiver3(S1L(1,4), S1L(2,4), S1L(3,4), S1L(1,2)*100, S1L(2,2)*100, S1L(3,2)*100, 0, 'Color', c6, 'LineWidth', 2, 'DisplayName', 'S1-L');
quiver3(S1R(1,4), S1R(2,4), S1R(3,4), S1R(1,2)*100, S1R(2,2)*100, S1R(3,2)*100, 0, 'Color', c6, 'LineWidth', 2, 'DisplayName', 'S1-R');

% SI1
quiver3(SI1L(1,4), SI1L(2,4), SI1L(3,4), SI1L(1,2)*100, SI1L(2,2)*100, SI1L(3,2)*100, 0, 'Color', c7, 'LineWidth', 2, 'DisplayName', 'SI1-L');
quiver3(SI1R(1,4), SI1R(2,4), SI1R(3,4), SI1R(1,2)*100, SI1R(2,2)*100, SI1R(3,2)*100, 0, 'Color', c7, 'LineWidth', 2, 'DisplayName', 'SI1-R');

% S2
quiver3(S2L(1,4), S2L(2,4), S2L(3,4), S2L(1,2)*100, S2L(2,2)*100, S2L(3,2)*100, 0, 'Color', c8, 'LineWidth', 2, 'DisplayName', 'S2-L');
quiver3(S2R(1,4), S2R(2,4), S2R(3,4), S2R(1,2)*100, S2R(2,2)*100, S2R(3,2)*100, 0, 'Color', c8, 'LineWidth', 2, 'DisplayName', 'S2-R');

grid on;
legend('show');